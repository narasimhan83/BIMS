@model BIMS.Models.Customer
@{ ViewData["Title"] = "Customer Details"; var currentLang = Context.Session.GetString("Language") ?? "en"; }

<div class="details-container">
    <div class="details-header">
        <h1><i class="icon">ğŸ‘¤</i> @(currentLang == "ar" ? "ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„" : "Customer Details")</h1>
        <div class="header-actions">
            <a asp-action="EditCustomer" asp-route-id="@Model.Id" class="btn-edit-header">âœï¸ @(currentLang == "ar" ? "ØªØ¹Ø¯ÙŠÙ„" : "Edit")</a>
            <a asp-action="Customers" class="btn-back">â† @(currentLang == "ar" ? "Ø§Ù„Ø¹ÙˆØ¯Ø©" : "Back")</a>
        </div>
    </div>

    <div class="details-card">
        <!-- Personal Information -->
        <div class="section-header">@(currentLang == "ar" ? "Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©" : "Personal Information")</div>
        <dl class="details-list">
            <dt>@(currentLang == "ar" ? "Ø§Ù„Ù†ÙˆØ¹:" : "Customer Type:")</dt>
            <dd>@(currentLang == "ar" && !string.IsNullOrEmpty(Model.CustomerType?.NameAr) ? Model.CustomerType.NameAr : Model.CustomerType?.Name)</dd>
            
            @if (Model.CustomerGroup != null)
            {
                <dt>@(currentLang == "ar" ? "Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©:" : "Group:")</dt>
                <dd>@(currentLang == "ar" && !string.IsNullOrEmpty(Model.CustomerGroup?.GroupNameAr) ? Model.CustomerGroup.GroupNameAr : Model.CustomerGroup?.GroupName)</dd>
            }

            @if (Model.Agent != null)
            {
                <dt>@(currentLang == "ar" ? "Ø§Ù„ÙˆÙƒÙŠÙ„:" : "Agent:")</dt>
                <dd>@Model.Agent.Name</dd>
            }
            
            <dt>@(currentLang == "ar" ? "Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„:" : "Customer Name:")</dt>
            <dd><strong>@(currentLang == "ar" && !string.IsNullOrEmpty(Model.CustomerNameAr) ? Model.CustomerNameAr : Model.CustomerName)</strong></dd>
            
            @if (!string.IsNullOrEmpty(Model.InsuredName))
            {
                <dt>@(currentLang == "ar" ? "Ø§Ø³Ù… Ø§Ù„Ù…Ø¤Ù…Ù† Ù„Ù‡:" : "Insured Name:")</dt>
                <dd>@(currentLang == "ar" && !string.IsNullOrEmpty(Model.InsuredNameAr) ? Model.InsuredNameAr : Model.InsuredName)</dd>
            }
            
            @if (Model.DateOfBirth.HasValue)
            {
                <dt>@(currentLang == "ar" ? "ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:" : "Date of Birth:")</dt>
                <dd>@Model.DateOfBirth.Value.ToString("dd/MM/yyyy")</dd>
            }
        </dl>

        <!-- Contact Information -->
        <div class="section-header">@(currentLang == "ar" ? "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„" : "Contact Information")</div>
        <dl class="details-list">
            <dt>@(currentLang == "ar" ? "Ø§Ù„Ø¬ÙˆØ§Ù„:" : "Mobile:")</dt>
            <dd>@(Model.MobilePhone ?? "-")</dd>
            
            <dt>@(currentLang == "ar" ? "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:" : "Email:")</dt>
            <dd>@(Model.Email ?? "-")</dd>
            
            <dt>@(currentLang == "ar" ? "Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:" : "Address:")</dt>
            <dd>@(currentLang == "ar" && !string.IsNullOrEmpty(Model.AddressAr) ? Model.AddressAr : (Model.Address ?? "-"))</dd>
        </dl>

        <!-- Identification -->
        <div class="section-header">@(currentLang == "ar" ? "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‡ÙˆÙŠØ©" : "Identification")</div>
        <dl class="details-list">
            <dt>@(currentLang == "ar" ? "Ø±Ù‚Ù… Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¯Ù†ÙŠ/Ø§Ù„ØªØ¬Ø§Ø±ÙŠ:" : "CPR/CR Number:")</dt>
            <dd>@(Model.CPR_CR_Number ?? "-")</dd>

            <dt>@(currentLang == "ar" ? "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ:" : "VAT Number:")</dt>
            <dd>@(Model.VATNumber ?? "-")</dd>

            @if (Model.CPRExpiryDate.HasValue)
            {
                <dt>@(currentLang == "ar" ? "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¯Ù†ÙŠ:" : "CPR Expiry Date:")</dt>
                <dd>@Model.CPRExpiryDate.Value.ToString("dd/MM/yyyy")</dd>
            }

            @if (!string.IsNullOrEmpty(Model.PassportNo))
            {
                <dt>@(currentLang == "ar" ? "Ø±Ù‚Ù… Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±:" : "Passport No:")</dt>
                <dd>@Model.PassportNo</dd>
            }

            @if (Model.PassportIssueDate.HasValue)
            {
                <dt>@(currentLang == "ar" ? "ØªØ§Ø±ÙŠØ® Ø¥ØµØ¯Ø§Ø± Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±:" : "Passport Issue Date:")</dt>
                <dd>@Model.PassportIssueDate.Value.ToString("dd/MM/yyyy")</dd>
            }

            @if (Model.PassportExpiryDate.HasValue)
            {
                <dt>@(currentLang == "ar" ? "ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø¬ÙˆØ§Ø² Ø§Ù„Ø³ÙØ±:" : "Passport Expiry Date:")</dt>
                <dd>@Model.PassportExpiryDate.Value.ToString("dd/MM/yyyy")</dd>
            }
        </dl>

        <!-- Documents -->
        <div class="section-header">
            @(currentLang == "ar" ? "Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª" : "Documents")
            <span class="badge badge-info">@(Model.Documents?.Count ?? 0)</span>
        </div>
        @if (Model.Documents?.Count > 0)
        {
            <div class="documents-grid">
                @foreach (var doc in Model.Documents)
                {
                    <div class="document-card">
                        <div class="doc-icon">ğŸ“„</div>
                        <div class="doc-info">
                            <strong>@(currentLang == "ar" && !string.IsNullOrEmpty(doc.DocumentType?.NameAr) ? doc.DocumentType.NameAr : doc.DocumentType?.Name)</strong>
                            <small>@doc.FileName</small>
                            <small>@(doc.FileSize.HasValue ? $"{doc.FileSize.Value / 1024} KB" : "")</small>
                        </div>
                        <a href="/Customer/DownloadDocument?id=@doc.Id" class="btn-download">â¬‡ï¸</a>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="no-data">@(currentLang == "ar" ? "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø³ØªÙ†Ø¯Ø§Øª" : "No documents uploaded")</p>
        }

        <!-- Vehicles -->
        <div class="section-header">
            @(currentLang == "ar" ? "Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª" : "Vehicles")
            <span class="badge badge-info">@(Model.Vehicles?.Count ?? 0)</span>
        </div>
        @if (Model.Vehicles?.Count > 0)
        {
            <div class="vehicles-grid">
                @foreach (var vehicle in Model.Vehicles)
                {
                    <div class="vehicle-card">
                        <div class="vehicle-header">
                            <strong>@(currentLang == "ar" && !string.IsNullOrEmpty(vehicle.VehicleMake?.MakeNameAr) ? vehicle.VehicleMake.MakeNameAr : vehicle.VehicleMake?.MakeName) 
                                    @(currentLang == "ar" && !string.IsNullOrEmpty(vehicle.VehicleModel?.ModelNameAr) ? vehicle.VehicleModel.ModelNameAr : vehicle.VehicleModel?.ModelName)</strong>
                        </div>
                        <dl class="vehicle-details">
                            <dt>@(currentLang == "ar" ? "Ø§Ù„Ø³Ù†Ø©:" : "Year:")</dt>
                            <dd>@(vehicle.VehicleYear?.Year)</dd>
                            <dt>@(currentLang == "ar" ? "Ø§Ù„Ø³Ø¹Ø©:" : "Capacity:")</dt>
                            <dd>
                                @{
                                    var capacityText = vehicle.EngineCapacity == null
                                        ? "-"
                                        : $"{vehicle.EngineCapacity.CapacityFrom} - {vehicle.EngineCapacity.CapacityTo} CC";
                                }
                                @capacityText
                            </dd>
                            <dt>@(currentLang == "ar" ? "Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„:" : "Registration:")</dt>
                            <dd>@(vehicle.RegistrationNumber ?? "-")</dd>
                            <dt>@(currentLang == "ar" ? "Ø±Ù‚Ù… Ø§Ù„Ø´Ø§Ø³ÙŠÙ‡:" : "Chassis:")</dt>
                            <dd>@(vehicle.ChassisNumber ?? "-")</dd>
                        </dl>
                    </div>
                }
            </div>
        }
        else
        {
            <p class="no-data">@(currentLang == "ar" ? "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±ÙƒØ¨Ø§Øª" : "No vehicles registered")</p>
        }
    </div>
</div>

<style>
    .details-container { padding: 20px; max-width: 1200px; margin: 0 auto; }
    .details-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
    .details-header h1 { font-size: 28px; color: var(--navy-dark); display: flex; align-items: center; gap: 10px; }
    .header-actions { display: flex; gap: 10px; }
    .btn-edit-header { padding: 10px 20px; background: #ffc107; color: white; border-radius: 8px; text-decoration: none; font-weight: 600; transition: all 0.3s ease; }
    .btn-edit-header:hover { background: #e0a800; }
    .btn-back { padding: 10px 20px; background: #6c757d; color: white; border-radius: 8px; text-decoration: none; transition: all 0.3s ease; }
    .btn-back:hover { background: #5a6268; }
    .details-card { background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); padding: 40px; }
    .section-header { font-size: 18px; font-weight: 700; color: var(--navy-dark); margin-bottom: 20px; margin-top: 30px; padding-bottom: 10px; border-bottom: 2px solid var(--primary-teal); display: flex; align-items: center; gap: 10px; }
    .section-header:first-of-type { margin-top: 0; }
    .details-list { display: grid; grid-template-columns: 200px 1fr; gap: 15px; margin-bottom: 30px; }
    .details-list dt { font-weight: 600; color: var(--navy-dark); }
    .details-list dd { color: #666; margin: 0; }
    .documents-grid, .vehicles-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px; }
    .document-card, .vehicle-card { background: #f8f9fa; border-radius: 8px; padding: 20px; display: flex; align-items: center; gap: 15px; border: 2px solid #e0e0e0; }
    .doc-icon { font-size: 32px; }
    .doc-info { flex: 1; }
    .doc-info strong { display: block; margin-bottom: 5px; }
    .doc-info small { display: block; color: #666; font-size: 12px; }
    .btn-download { padding: 8px 12px; background: var(--primary-teal); color: white; border-radius: 6px; text-decoration: none; font-size: 18px; transition: all 0.3s ease; }
    .btn-download:hover { background: var(--teal-dark); transform: scale(1.1); }
    .vehicle-card { flex-direction: column; align-items: flex-start; }
    .vehicle-header { font-size: 16px; margin-bottom: 10px; color: var(--navy-dark); }
    .vehicle-details { display: grid; grid-template-columns: 120px 1fr; gap: 8px; width: 100%; font-size: 14px; }
    .vehicle-details dt { font-weight: 600; color: #666; }
    .vehicle-details dd { color: #333; margin: 0; }
    .no-data { color: #999; font-style: italic; padding: 20px; text-align: center; background: #f8f9fa; border-radius: 8px; }
    .badge { padding: 5px 12px; border-radius: 12px; font-size: 12px; font-weight: 600; margin-left: 10px; }
    .badge-info { background: #17a2b8; color: white; }
    @@media (max-width: 768px) { .details-list { grid-template-columns: 1fr; } .documents-grid, .vehicles-grid { grid-template-columns: 1fr; } }
</style>